<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VDCQV2V8VS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-VDCQV2V8VS');
    </script>
    <meta charset="UTF-8">
    <title>Memory NCA</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
    <symbol id="playIcon" viewBox="0 0 24 24">
        <path d="M8 5v14l11-7z"></path>
        <path d="M0 0h24v24H0z" fill="none"></path>
    </symbol>
    <symbol id="pauseIcon" viewBox="0 0 24 24">
        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>
        <path d="M0 0h24v24H0z" fill="none"></path>
    </symbol>
    <symbol id="resetIcon" viewBox="0 0 24 24">
        <path d="M0 0h24v24H0z" fill="none"></path>
        <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"></path>
    </symbol>
    <symbol id="zoomInIcon" viewBox="0 0 24 24">
        <path d="M0 0h24v24H0V0z" fill="none"/>
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        <path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"/>
    </symbol>

    <div class="container">
        <div class="header">
            <h1>Exploring the Landscape of Non-Equilibrium Memories with Neural Cellular Automata</h1>
            <p></p>
        </div>

        <div class="demo-section">
            <div class="main-content">

                <div class="canvas-section">
                    <div class="demo-tip">
                        <img id="pointer" src="images/pointer.svg" width="40px" height="40px"/>
                        <div class="hint ">
                            Click or tap to change the state of the CA with the brush.
                        </div>
                    </div>
                    <div class="canvas-container">
                        <canvas id="c" width="600" height="600"></canvas>
                    </div>

                    <div class="canvas-controls">
                        <div style="text-align: left;">
                        <span id="play-pause">
                          <svg class="icon" id="play" style="display: none;"><use xlink:href="#playIcon"></use></svg>
                          <svg class="icon" id="pause"><use xlink:href="#pauseIcon"></use></svg>
                        </span>
                            <svg class="icon" id="reset_state">
                                <use xlink:href="#resetIcon"></use>
                            </svg>
                            <svg class="icon" id="reset_CA" style="fill: white; background: indianred;">
                                <use xlink:href="#resetIcon"></use>
                            </svg>
                        </div>

                        <div>
                            <div class="slider-container" style="">
                                <input type="range" id="spf" class="slider" min="-4" max="4" value="-1">
                                <label>Steps/Frame: </label> <label class="slider-value" id="spf-value">1/3x</label>
                            </div>
                        </div>

                        <div id='brush-bit-select' class="button-group">
                            <label>
                                <input type="radio" name="brush-bit"><img src="images/0.png" width="34px"
                                                                          height="34px"/>
                            </label>
                            <label>
                                <input type="radio" name="brush-bit" checked="checked"><img src="images/1.png"
                                                                                            width="34px"
                                                                                            height="34px"/>
                            </label>
                            <label>
                                <input type="radio" name="brush-bit"><img src="images/noise.png"
                                                                          width="34px" height="34px"/>
                            </label>
                            <br> Brush Bit
                        </div>

                        <div>
                            <div class="slider-container">
                                <input type="range" id="noise-prob" class="slider" min="0" max="1" step="0.001"
                                       value="0.1" style="margin-top:30px;">
                                <label>Noise Probability ($p$): </label> <label class="slider-value"
                                                                          id="noise-prob-value">0.1</label>
                            </div>
                        </div>


                        <div id='brush-size-select' class="button-group">
                            <label>
                                <input type="radio" name="brush-size"><img
                                    src="images/brush_S.png" width="34px" height="34px"/>
                            </label>
                            <label>
                                <input type="radio" name="brush-size" checked="checked"><img src="images/brush_M.png"
                                                                                             width="34px"
                                                                                             height="34px"/>
                            </label>
                            <label>
                                <input type="radio" name="brush-size"><img
                                    src="images/brush_L.png" width="34px" height="34px"/>
                            </label>
                            <br> Brush Size
                        </div>

                        <div>
                            <div class="slider-container">
                                <input type="range" id="noise-bias" class="slider" min="-1" max="1" step="0.001"
                                       value="0.0" style="margin-top:20px;">
                                <label>Noise Bias ($\eta$): </label> <label class="slider-value"
                                                                   id="noise-bias-value">0.0</label>
                            </div>
                        </div>


                    </div>


                    <div class="rule-visualizer">
                        <canvas id="imageCanvas" width="605" height="301"></canvas>
                        <canvas id="overlayCanvas" width="605" height="301"></canvas>
                    </div>
                    <div class="demo-tip">
                        <img id="pointer" src="images/pointer.svg" width="40px" height="40px"/>
                        <div class="hint ">
                            Double click on the rule above to edit it. To revert, press the red reset button.
                        </div>
                    </div>


                </div>

                <div class="controls-section">
                    <div class="control-group">
                        <h3>Simulation Parameters</h3>

                        <div class="control-item">
                            <label>CA Rule</label>
                            <select id="rule-select" class="custom-select">
                            </select>
                        </div>

                        <div class="control-item">
                            <label>Grid Size</label>
                            <div class="slider-container">
                                <input type="range" id="grid-size" class="slider" min="16" max="400" value="100">
                                <div class="slider-value" id="grid-size-value">100</div>
                            </div>
                        </div>

                        <div class="control-item">
                            <label>Update Probability ($\alpha$)</label>
                            <div class="slider-container">
                                <input type="range" id="update-prob" class="slider" min="0.001" max="1" step="0.001"
                                       value="1">
                                <div class="slider-value" id="update-prob-value">1</div>
                            </div>
                        </div>


                        <div class="control-group">
                            <h3>Initial Condition</h3>

                            <div id='init-bit-select' class="button-group"
                                 style="background: transparent; text-align: center">
                                <label>
                                    <input type="radio" name="init-bit" checked="checked"><img
                                        src="images/0.png" width="90px" height="90px"/>
                                </label>
                                <label>
                                    <input type="radio" name="init-bit"><img src="images/1.png" width="90px"
                                                                             height="90px"/>
                                </label>
                                <label>
                                    <input type="radio" name="init-bit"><img
                                        src="images/noise_hr.png" width="90px" height="90px"/>
                                </label>
                            </div>
                        </div>

                        <div class="control-group">
                            <h3>Current Rule</h3>
                            <div class="current-rule-display" id="current_rule">
                                Loading rule...
                            </div>
                        </div>

                        <div class="control-group">
                            <h3>Add a New Rule</h3>
                            <div class="rule-input-section">
                                <h4>Custom Rule</h4>
                                <div class="input-group">
                                    <input type="text" id="rule_name" class="input-field" placeholder="Rule Name">
                                </div>
                                <div class="input-group">
                                    <input type="text" id="rule_code" class="input-field code-input"
                                           placeholder="512-bit Binary Code">
                                </div>
                                <button id="add_rule" class="btn btn-primary" style="width: 100%;">Add Rule</button>
                            </div>
                        </div>


                    </div>
                </div>
            </div>

            <!-- Article Section -->
            <div class="article-section" id="article-content">

            </div>


        </div>
        <script src="swissgl.js"></script>
        <script src="ca.js"></script>
        <script>
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    displayMath: [['$$', '$$'], ['\\[', '\\]']],
                    processEscapes: true,
                    processEnvironments: true
                },
                options: {
                    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
                }
            };
        </script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/marked/lib/marked.umd.js"></script>


        <script>
            const blogMarkdown = `
# Memory Cellular Automata

*read the paper here:* [arxiv:2508.15726](https://arxiv.org/abs/2508.15726)

Cellular automata (CA) are a useful framework for exploring how simple dynamical rules can give rise to complex emergent behavior. We consider CA which act on binary cells living on a 2D grid. The cells are updated in time according to a specified local update rule, which takes as input the 3x3 neighborhood surrounding each cell.

There exist many CA which produce interesting emergent behavior, perhaps the most famous being [Conway's game of life](https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life). However, almost all known CA (including the game of life) are extremely fragile: in the presence of an arbitrarily small amount of noise, the emergent structures they produce are rapidly destroyed.

The simplest nontrivial computation a CA can perform is to remember a single bit of information. *Memory CA* are CA that remember this information in a robust way, with the information being preserved even in the presence of a small amount of noise. The construction of memory CA can be viewed as a stepping stone on a path towards creating life-like systems capable of robust computation and self-organization.

How are memory CA constructed, and in what types of settings can they exist? We do not yet have universal answers to these questions. For many years, the only memory CA studied was a rule known as [Toom's rule](https://en.wikipedia.org/wiki/Toom%27s_rule). To search for other memory CA, we used a modification of the [neural cellular automata framework](https://distill.pub/2020/growing-ca/?ref=https://githubhelp.com), a simple machine learning architecture which we used to discover many new memory CA, some of which can be experimented with in the demo above.

## Using the demo

The visualization above shows the evolution of a grid of binary cells under a given CA rule. 
Since there are $2^9 = 512$ possible configurations of 3x3 blocks of cells, each CA rule can be specified by a binary string of length 512 which tabulates the CA's outputs on each of the 512 possible inputs; this string is the binary code in the demo above.
The binary code can be modified by double-clicking on the green and red squares below the demo window (green squares indicate that the CA outputs 1 on the given input; red squares indicate that it outputs 0).

### Update Rules

In the demo, the dynamics is subject to noise of strength $p$ and bias $\\eta$, and cells update according to an update probability $\\alpha$. The following things happen at each time step:

1. Each site is independently chosen to be updated with probability $\\alpha$ (at $\\alpha = 1$ all sites update synchronously, while at $\\alpha \\rightarrow 0$ they update according to independent Poisson processes).
2. If a site updates, it does so according to the given CA rule with probability $1-p$, and suffers noise with probability $p$. If noise occurs, the state of the cell becomes $0$ or $1$ with probability $(1-\\eta)/2$ and $(1+\\eta)/2$, respectively.

### Distributed Error Correction 

The crucial feature of memory CA is that they are able to correct noise-induced errors in a *distributed, autonomous* manner. In the demo, the way that each CA accomplishes this can be investigated by using the brush to create a large island of errors, and watching how the island is eroded by the CA dynamics (provided the noise strength is not too large). Different memory CA erode islands of errors in qualitatively distinct ways. 

### Phase Transitions 

One interesting phenomenon in the physics of memory CA is the existence of sharp *phase transitions*, which occurs at the points where the effects of noise are strong enough to destroy the memory. These phase transitions can be driven by changing the noise strength, the noise bias, or the synchronicity of the updates. In the rule D CA, there is a regime where the memory can even be destroyed by *decreasing* the noise. We recommend playing around with different modified CA rules and seeing how the locations of the phase transitions are modified.  

---

*This interactive demonstration is built using SwissGL.*
        `;

            // Configure marked options for better rendering
            marked.setOptions({
                breaks: false,
                gfm: true,
                headerIds: true,
                headerPrefix: 'section-'
            });

            // Function to render markdown with math
            function renderContent() {
                const contentDiv = document.getElementById('article-content');

                // First render the markdown
                contentDiv.innerHTML = marked.parse(blogMarkdown);

                // Then process the math with MathJax
                if (window.MathJax && window.MathJax.typesetPromise) {
                    window.MathJax.typesetPromise([contentDiv]).catch(function (err) {
                        console.log('MathJax error:', err.message);
                    });
                }
            }

            // Wait for everything to load
            document.addEventListener('DOMContentLoaded', function () {
                // Small delay to ensure MathJax is ready
                setTimeout(renderContent, 100);
            });

            // Also try when window loads as backup
            window.addEventListener('load', function () {
                setTimeout(renderContent, 200);
            });

        </script>
</body>
</html>
